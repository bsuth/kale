local C = require('erde.constants')

-- -----------------------------------------------------------------------------
-- Name
-- -----------------------------------------------------------------------------

local Name = { ruleName = 'Name' }

-- -----------------------------------------------------------------------------
-- Parse
-- -----------------------------------------------------------------------------

function Name.parse(ctx)
  assert(
    ctx.token:match('^[_a-zA-Z][_a-zA-Z0-9]*$'),
    'Malformed name: ' .. ctx.token
  )

  for i, keyword in pairs(C.KEYWORDS) do
    assert(ctx.token ~= keyword, 'Cannot use keyword as name: ' .. ctx.token)
  end

  return { value = ctx:consume() }
end

-- -----------------------------------------------------------------------------
-- Compile
-- -----------------------------------------------------------------------------

function Name.compile(ctx, node)
  return node.value
end

-- -----------------------------------------------------------------------------
-- Return
-- -----------------------------------------------------------------------------

return Name
